## name override
fullnameOverride: age-secret-controller
  
## namespaces in wich new keys will be generated
## controller will also check in them for keys to decrypt  
keyNamespaces: "age-secrets"

## controller values  
ageSecretController:

## leader election
  leaderElection:
    enabled: true
    namespace: age-system

  ## replicas for ha
  replicas: 3

  controller:
    ## image
    image:
      repository: callmewhatuwant/age-secrets-operator
      tag: 0.0.10
    imagePullPolicy: IfNotPresent

    ## resources
    resources:
      limits:
        cpu: 200m
        memory: 128Mi
      requests:
        cpu: 100m
        memory: 64Mi

    ## security
    containerSecurityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
        - ALL
      seccompProfile:
        type: "RuntimeDefault"
      runAsNonRoot: true
      privileged: false
      runAsUser: 65532
      runAsGroup: 65532

## prometheus
metricsService:
  bindAddress: 8443
  secure: true
  auth: false
  
  type: ClusterIP
  ports:
    - port: 8443
      name: metrics
      targetPort: 8443

## monitor for prometheus
ServiceMonitor:
  enabled: false
  endpoints:
    - port: metrics
      scheme: https
      interval: 30s
      path: /metrics
      tlsConfig:
        insecureSkipVerify: true
        serverName: localhost
        
## job
ageKeyRotation:
  schedule: "0 0 1 * *"
  ## initial key
  initialRun:
    enabled: true

  ## image for cron and init job
  image:
    repository: callmewhatuwant/age-job
    tag: "3.22.2-1"
    pullPolicy: IfNotPresent

## gui
ageGui:
  enabled: true
  replicas: 1

  # image for gui
  image:
    repository: callmewhatuwant/age-gui
    tag: "alpine3.22-perl-1"
    pullPolicy: IfNotPresent

  resources:
    limits:
      cpu: 200m
      memory: 128Mi
    requests:
      cpu: 100m
      memory: 64Mi
    
  # strategy for updating
  strategy:
    type: RollingUpdate
    rollingUpdate:
      maxSurge: "25%"
      maxUnavailable: "25%"

  #sec context
  containerSecurityContext:
    allowPrivilegeEscalation: false
    capabilities:
      drop:
        - ALL
    seccompProfile:
      type: "RuntimeDefault"
    runAsNonRoot: true
    privileged: false
    runAsUser: 101
    runAsGroup: 101

  # service for gui
  service:
    type: ClusterIP
    ports:
      - name: http
        port: 80
        targetPort: 8080
        protocol: TCP

  # ingress for gui
  ingress:
    enabled: false
    host: age-gui.local
    ingressClassName: nginx
    annotations: {}
    tls: []
      # - hosts:
      #     - age-gui.local
      #   secretName: age-gui-tls
